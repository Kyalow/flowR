---
title: "*flowR* quick tutorial"
author: "Guillaume Voisinne"
date: "11/20/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This tutorial will walk you through the analysis of a example dataset with *flowR*. It is freely adapted from ... .

## Data

The data can be loaded by clicking on the **Import example dataset** button in the **Import** tab. FCS files can also be downloaded using this link. To load data from FCS files, click on **browse** to select and import files. Imported files will be displayed on the right panel. Select one or multiple files and click on **load** to create a collection of samples, an object that we will call a **flowSet** in the following. The name of the flowSet is "Import" by default. In this tutorial, we'll keep this default name and refer to the imported data as the "Import flowSet".

## Metadata

Metadata refers to the information about the different samples in the flowSet. Go to the **Metdata** tab to see what information we have about these samples. You should see a table with a single column "name" containing the names of the different samples in the flowSet. FCS files usually store relevant information as **keywords**. It is possible to retrieve sample information stored as FCS keywords on the right panel. Select the **SRC** keyword in the drop-down slection menu on the right panel and click on **Add keywords**. A column **SRC** now appears in the metadata table. This column contains information about the different patients from which the samples were collected. We will use this information later to compare results across patients.

## Tranform

In the **Transform** tab, we can see a table with all the parameters (observables) that have been measured for each sample in the flowSet. This table displays in particular the name of each parameter along with its description. This description is retieved automatically from FCS files but can be also be edited manually using the **Edit** tab. The data that we are dealing with has been generated by a CyTOF instrument. As such, we need to transfom most observables using the 'asinh' function. Select all variables except 'Time' and 'event_length', then select "asinh" from the drop-down menu in the **Transform** tab and click on the **apply to selected channels** button. The effect on the asinh transformation can be appreciated on the histogram displayed on the right pannel. So far, transformation  

## Compensation

Mass cytometry data usually display limited spillover between channels. We can check spillover between channels in the **Compensate** tab. The spillover matrix is displayed on the left pannel. It is automatically retrieved from the FCS file of the first sample in the flowSet. Here, no compensation has been applied so the spillover matrix is the identity matrix with zeros everywhere except for ones on its diagonal. Clicking on the matrix will display a 2D plot on the right pannel allowing to appreciate the spillover between the selected parameters. By convention, we use the signal in the channel corresponding to the emitting fluorophore as the y-axis parameter and the signal in other channel as the x-axis parameter.

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
